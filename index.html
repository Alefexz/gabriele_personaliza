<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja | Gabriele Personaliza</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="container">
            <a href="#" class="logo">Gabriele <span>Personaliza</span></a>
            <nav>
                <div class="menu-toggle"><i class="fas fa-bars"></i></div>
                <ul class="nav-links">
                    <li><a href="#loja" class="active">Loja</a></li>
                    <li><a href="#sobre">Sobre</a></li>
                    <li><a href="https://wa.me/559292770409" target="_blank" class="btn-nav">Falar no WhatsApp</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="welcome-banner">
        <div class="container">
            <h1>Seja bem-vindo(a)!</h1>
            <p>Transforme sua festa com nossa papelaria criativa feita √† m√£o.</p>
            <div class="arrow-down">
                <i class="fas fa-chevron-down"></i>
            </div>
        </div>
    </section>

    <section id="loja" class="section-padding store-section">
        <div class="container">
            
            <div class="filter-container">
                <button class="filter-btn active" data-filter="todos">Todos</button>
                <button class="filter-btn" data-filter="festa">Festas</button>
                <button class="filter-btn" data-filter="cadernos">Cadernos</button>
                <button class="filter-btn" data-filter="mimos">Mimos</button>
            </div>

            <div class="product-grid" id="container-produtos">
                <p style="text-align:center; width:100%; grid-column: 1 / -1; padding: 40px;">
                    <i class="fas fa-circle-notch fa-spin"></i> Carregando novidades...
                </p>
            </div>
        </div>
    </section>

    <section id="sobre" class="section-padding" style="background: #fff;">
        <div class="container about-container">
            <div class="about-text">
                <h2 class="section-title" style="text-align: left;">Quem faz?</h2>
                <p>A <strong>Gabriele Personaliza</strong> nasceu do desejo de transformar papel em mem√≥rias eternas. O que come√ßou como um hobby criativo, hoje √© uma marca dedicada a levar beleza e afeto para os seus momentos especiais.</p>
                <p style="margin-top: 15px;">Nosso atelier √© especializado em <strong>papelaria criativa e personalizados para festas</strong>. Trabalhamos com design exclusivo, cortes precisos e montagem feita 100% √† m√£o.</p>
            </div>
        </div>
    </section>

    <footer id="contato">
        <div class="container">
            <div class="footer-brand">
                <h3>Gabriele Personaliza</h3>
                <p>Feito com amor.</p>
            </div>
            
            <div class="socials">
                <a href="https://www.instagram.com/gabriele_personaliza/" target="_blank"><i class="fab fa-instagram"></i></a>
                <a href="https://wa.me/559292770409" target="_blank"><i class="fab fa-whatsapp"></i></a>
            </div>

            <div class="footer-support">
                <p>Entre em contato com o suporte: <a href="mailto:contato.gabriele.personaliza@gmail.com">contato.gabriele.personaliza@gmail.com</a></p>
            </div>
            
            <div class="copyright" id="area-secreta" style="cursor: help;" title="Acesso Restrito ¬© 2026">
                <p>&copy; 2026 Gabriele Personaliza.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // SUA CONFIGURA√á√ÉO
        const firebaseConfig = {
            apiKey: "AIzaSyBrRLiEFF8dfWHVxhK3popdYgEDQLiKzCM",
            authDomain: "gabriele-personaliza.firebaseapp.com",
            projectId: "gabriele-personaliza",
            storageBucket: "gabriele-personaliza.firebasestorage.app",
            messagingSenderId: "403724311605",
            appId: "1:403724311605:web:850e1bb14459a3ec60e57c",
            measurementId: "G-T24GYM57CT"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 1. CARREGAR PRODUTOS DO BANCO
        async function carregarLoja() {
            const container = document.getElementById('container-produtos');
            
            try {
                const querySnapshot = await getDocs(collection(db, "produtos"));
                
                if(querySnapshot.empty) {
                    container.innerHTML = '<p style="text-align:center; grid-column: 1/-1;">Nenhum produto cadastrado ainda. Acesse o painel para adicionar.</p>';
                    return;
                }

                container.innerHTML = ''; 

                querySnapshot.forEach((doc) => {
                    const p = doc.data();
                    
                    // -- L√ìGICA DE ESTOQUE (ATIVO/INATIVO) --
                    let botaoAcao = '';
                    let estiloExtra = '';
                    let etiqueta = '';

                    if (p.ativo) {
                        botaoAcao = `<a href="https://wa.me/559292770409?text=Ol√°, quero encomendar o ${p.nome}!" class="btn-sm" target="_blank">Pedir no WhatsApp</a>`;
                    } else {
                        botaoAcao = `<span class="btn-sm" style="color:red; cursor:not-allowed;">Esgotado</span>`;
                        estiloExtra = 'opacity: 0.6; filter: grayscale(1);'; // Deixa cinza se esgotado
                        etiqueta = '<div class="badge-bestseller" style="background:#F44336;">Esgotado</div>';
                    }

                    // -- L√ìGICA DA FOTO (Base64 ou Placeholder) --
                    let imagemHtml = '';
                    
                    // Se tiver foto salva no banco (come√ßa com data:image...), usa ela
                    if (p.foto && p.foto.startsWith('data:image')) {
                        imagemHtml = `<img src="${p.foto}" style="width:100%; height:100%; object-fit:cover; ${estiloExtra}">`;
                    } 
                    // Se n√£o tiver, usa o √≠cone colorido padr√£o
                    else {
                        let icone = 'fa-star';
                        let corBg = '#E1BEE7';
                        // Define cor baseada na categoria
                        if(p.categoria === 'festa') { icone = 'fa-birthday-cake'; corBg = '#D1C4E9'; }
                        if(p.categoria === 'cadernos') { icone = 'fa-book-open'; corBg = '#BBDEFB'; }
                        if(p.categoria === 'mimos') { icone = 'fa-sticky-note'; corBg = '#F8BBD0'; }
                        
                        imagemHtml = `
                            <div class="placeholder-img" style="background-color: ${corBg}; ${estiloExtra}">
                                <i class="fas ${icone}"></i>
                            </div>`;
                    }

                    // -- DETALHES ESPECIAIS (S√≥ para o Kit Festa) --
                    let detalhesExtra = '';
                    if(p.nome.toLowerCase().includes('kit festa')) {
                        detalhesExtra = `
                        <ul class="kit-details">
                            <li><i class="fas fa-check"></i> Itens personalizados</li>
                            <li><i class="fas fa-check"></i> Papelaria premium</li>
                        </ul>`;
                    }

                    // MONTA O CARD DO PRODUTO
                    const html = `
                    <div class="product-card" data-category="${p.categoria}">
                        <div class="product-img-wrapper" style="height: 220px; overflow: hidden; position: relative;">
                            ${etiqueta}
                            ${imagemHtml}
                        </div>
                        <div class="product-info">
                            <span class="category-tag">${p.categoria}</span>
                            <h3>${p.nome}</h3>
                            <div class="product-price">R$ ${p.preco}</div>
                            ${detalhesExtra}
                            ${botaoAcao}
                        </div>
                    </div>
                    `;
                    container.innerHTML += html;
                });

            } catch (error) {
                console.error("Erro na loja:", error);
                container.innerHTML = '<p style="text-align:center; grid-column: 1/-1;">Erro ao carregar produtos. Verifique sua conex√£o.</p>';
            }
        }

        // Chama a fun√ß√£o ao abrir o site
        carregarLoja();

        // 2. SISTEMA DE LOGIN SECRETO (PRESSIONAR POR 2 SEGUNDOS)
        const areaSecreta = document.getElementById('area-secreta');
        let pressTimer;

        // Fun√ß√£o que abre a senha
        const abrirAdmin = () => {
            const senha = prompt("üîí √Årea Restrita da Gabriele.\nDigite a senha de acesso:");
            if(senha === "gabi123") {
                sessionStorage.setItem('admin_logado', 'sim');
                window.location.href = 'admin.html';
            } else if (senha !== null) {
                alert("Senha incorreta!");
            }
        };

        // Para Celular (Touch)
        areaSecreta.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Evita zoom ou menu de contexto
            pressTimer = setTimeout(abrirAdmin, 2000); // Espera 2 segundos
        });
        
        areaSecreta.addEventListener('touchend', () => {
            clearTimeout(pressTimer); // Se soltar antes, cancela
        });

        // Para Computador (Mouse)
        areaSecreta.addEventListener('mousedown', () => {
            pressTimer = setTimeout(abrirAdmin, 2000); // Espera 2 segundos
        });
        
        areaSecreta.addEventListener('mouseup', () => {
            clearTimeout(pressTimer);
        });